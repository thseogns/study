# state as a snapshot

상태 변수는 읽고 쓸 수 있는 일반 자바스크립트 변수처럼 보일 수 있습니다. 
하지만 상태는 *스냅샷*처럼 동작합니다. 

state변수가 재설정되면 본래있던 state값이 변하는 것이 아니라 새로 렌더링되어 값이 설정된다.



1상태 설정이 리렌더를 트리거하는 방법
2상태 업데이트 시기 및 방법
3상태를 설정한 직후에 상태가 업데이트되지 않는 이유
4이벤트 핸들러가 상태의 '스냅샷'에 액세스하는 방법


## 상태 트리거를 설정하면 렌더링 
클릭과 같은 사용자 이벤트에 반응하여 사용자 인터페이스가 직접 변경되는 것으로 생각할 수 있습니다.
React에서는 이러한 멘탈 모델과는 조금 다르게 작동합니다. 이전 페이지에서 상태 설정이 React에 다시 렌더링을 요청하는 것을 보았습니다. 
즉, 인터페이스가 이벤트에 반응하려면 state를 업데이트해야 합니다.

*랜더링 순서*
onSubmit 이벤트 핸들러가 실행됩니다.
setIsSent(true)는 isSent를 true로 설정하고 새 렌더링을 큐에 넣습니다.
React는 새로운 isSent 값에 따라 컴포넌트를 다시 렌더링합니다.
state와 렌더링의 관계를 자세히 살펴봅시다.

렌더링은 시간의 스냅샷을 찍습니다.
랜더링이랑 react가 component , 즉 함수를 호출하는 것을 의미함 
로퍼, 이벤트 핸들러, 로컬 변수는 모두 렌더링 당시의 상태를 기준으로 사용된다..


## React가 component를 리렌더링할 때 
함수를 호출 = > 함수는 새로운 JSX 스냅샷을 반환 => React는 반환한 스냅샷과 같게 화면을 업뎃
(React 함수 실행하기=> 스냅샷 계산하기=> DOM 트리 업데이트하기)


react에게 state를 업데이트하라고 지시 = > react가 state값을 업데이트 = > 상태값의 스냅샷을 컴포넌트에 전달




컴포넌트의 메모리로서 state는 함수가 반환된 후 사라지는 일반 변수와 다릅니다. state는 실제로 함수 외부에 마치 선반에 있는 것처럼 React 자체에 "존재"합니다.
React가 컴포넌트를 호출하면 특정 렌더링에 대한 상태의 스냅샷을 제공합니다. 
컴포넌트는 해당 렌더링의 상태 값을 사용해 계산된 새로운 프로퍼티 세트와 이벤트 핸들러가 포함된 UI의 스냅샷을 JSX에 반환합니다!


React에게 state를 업데이트하라고 지시합니다.

React가 state 값을 업데이트합니다.

React는 상태 값의 스냅샷을 컴포넌트에 전달합니다.

레이첼 리 네이버스의 일러스트
다음은 이것이 어떻게 작동하는지 보여주는 작은 실험입니다. 이 예시에서는 "+3" 버튼을 클릭하면 setNumber(숫자 + 1)를 
세 번 호출하기 때문에 카운터가 세 번 증가할 것으로 예상할 수 있습니다.


### 아래 코드의 numer는 버튼당 1
```
import { useState } from 'react';

export default function Counter() {
  const [number, setNumber] = useState(0);


  return (
    <>
      <h1>{number}</h1>
      <button onClick={() => {
        setNumber(number + 1);
        setNumber(number + 1);
        setNumber(number + 1);
      }}>+3</button>
    </>
  )
}`
  ```
setNumber(number + 1): 숫자는 0이므로 setNumber(0 + 1).
React는 다음 렌더링에서 숫자를 1로 변경할 준비를 합니다.
setNumber(number + 1): 숫자는 0이므로 setNumber(0 + 1).
React는 다음 렌더링에서 숫자를 1로 변경할 준비를 합니다.
setNumber(number + 1): 숫자는 0이므로 setNumber(0 + 1).
React는 다음 렌더링에서 숫자를 1로 변경할 준비를 합니다.
setNumber(number + 1)를 세 번 호출했지만, 이 렌더링의 이벤트 핸들러에서 숫자는 항상 0이므로 상태를 1로 세 번 설정한 것입니다.
그렇기 때문에 이벤트 핸들러가 완료된 후 React는 컴포넌트를 3이 아닌 1로 다시 렌더링합니다.


기본값에서 변경이 이루어지고 그후 한번에 변경값이 적용된다.

스냅샷은 사용자가 변경하기 시작한 시점 부터 값을 전달하고 그후 그값에대한 결과를 출력한다.
*그값이 비동기 적이라도 값은 같다.*
덕분에 비동기적 실행후 값이 변화했을때 결과물이 바뀌는 걱정을 하지 않아도 된다.
