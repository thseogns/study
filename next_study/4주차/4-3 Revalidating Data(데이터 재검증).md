# Revalidating Data  
Next.js를 사용하면 전체 사이트를 다시 빌드할 필요 없이 특정 정적 경로를 업데이트할 수 있습니다.  
재검증(증분 정적 재생성이라고도 함)을 사용하면 정적의 이점을 유지하면서 수백만 페이지로 확장할 수 있습니다.  

#### Next.js에는 두 가지 유형의 재검증이 있습니다:

Background: 특정 시간 간격으로 데이터를 재검증합니다.   
On-demand: 업데이트와 같은 이벤트를 기반으로 데이터의 유효성을 재검증합니다.  

Background Revalidation
특정 간격으로 캐시된 데이터를 재검증하려면 fetch()에서  
next.revalidate 옵션을 사용하여 리소스의 캐시 life(초){유지시간??}을 설정할 수 있습니다.  
![image](https://github.com/ddp-study/nextjs/assets/99688960/639ec0ef-2422-4985-ab6f-c24b1d229483)  
Fetch를 사용하지 않는 데이터(예: 외부 패키지 또는 쿼리 빌더 사용)의 유효성을  
다시 확인하려면 Route Segment Config를 사용할 수 있습니다.
![image](https://github.com/ddp-study/nextjs/assets/99688960/e81d2eae-ea44-47ab-8d3d-8e14d318e5fc)  
fetch 외에도 캐시를 사용하여 데이터의 유효성을 다시 검사할 수도 있습니다.  
#### 작동 방식
1. 빌드 시점에 정적으로 렌더링된 경로에 대한 요청이 이루어지면 처음에는 캐시된 데이터가 표시됩니다.  
2. 최초 요청 이후 60초 이전의 경로에 대한 모든 요청도 캐시되어 즉시 표시됩니다.  
3. 60초가 지난 후에도 다음 요청에는 캐시된(오래된) 데이터가 계속 표시됩니다.  
4. Next.js는 백그라운드에서 데이터 재생성을 트리거합니다.  
5. 경로가 성공적으로 생성되면 Next.js는 캐시를 무효화하고 업데이트된 경로를 표시합니다.  
  백그라운드 재생성이 실패하면 이전 데이터는 여전히 변경되지 않습니다.  

생성되지 않은 경로 세그먼트에 대한 요청이 이루어지면 Next.js는 첫 번째 요청에서 경로를 동적으로 렌더링합니다.  
이후 요청은 캐시에서 정적 경로 세그먼트를 제공합니다. ??


On-demand Revalidation 
재검증 시간을 60으로 설정하면 모든 방문자에게 1분 동안 동일하게 생성된 사이트 버전이 표시됩니다.  
캐시를 무효화하는 유일한 방법은 1분 경과 후 누군가 페이지를 방문하는 경우입니다.(1분후에 재검증된다?)
#### On-Demand 재검증 사용 
 데이터는 경로(revalidatePath) 또는 캐시 태그(revalidateTag)를   
 기준으로 
On-demand Revalidation할 수 있습니다.  
![image](https://github.com/ddp-study/nextjs/assets/99688960/70b0f67c-d9d1-4d5c-9c0a-4dfca44234ef)   
이렇게 캐시된 데이터는 라우트 핸들러에서 재검증태그를 호출하여 온디맨드 방식으로 재검증할 수 있습니다.  
![image](https://github.com/ddp-study/nextjs/assets/99688960/87602add-4d48-4e6a-a361-8cf5b6bcfff4)  

##### 오류 처리 및 재검증  
데이터 재검증을 시도하는 동안 오류가 발생하면 마지막으로 성공적으로 생성된 데이터가 캐시에서 계속 제공됩니다.  
다음 후속 요청 시 Next.js는 데이터 재밸리데이션을 다시 시도합니다.

 
